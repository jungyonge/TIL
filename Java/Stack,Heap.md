
#Stack,Heap

- Static area(스태틱 메모리 영역)  
 하나의 JAVA 파일은 크게 필드(field), 생성자(constructor), 메소드(method)로 구성된다.   
 그중 필드 부분에서 선언된 변수(전역변수)와 정적 멤버변수(static이 붙은 자료형) Static 영역에 데이터를 저장한다.   
 Static 영역의 데이터는 프로그램의 시작부터 종료가 될 때까지 메모리에 남아있게 된다.   
 다르게 말하면 전역변수가 프로그램이 종료될 때까지 어디서든 사용이 가능한 이유이기도 하다.   
 따라서 전역변수를 무분별하게 많이 사용하다 보면 메모리가 부족할 우려가 있어 필요한 변수만 사용할 필요가 있다.
 
- Stack area(스택 메모리 영역)  
     우리가 현재까지 작성하던 메소드 내에서 정의하는 기본 자료형(int, double, byte, long, boolean 등)에 해당되는 지역변수(매개 변수 및 블럭문 내 변수 포함)의 데이터의 값이   
     저장되는 공간이 Stack(스택) 영역이다. 해당 메소드가 호출될 때 메모리에 할당되고 종료되면 메모리가 해제된다. 
     - Heap 영역에 생성된 Object 타입의 데이터의 참조값이 할당된다.
     - 원시타입의 데이터가 값과 함께 할당된다.
     - 지역변수들은 scope 에 따른 visibility 를 가진다.
     - 각 Thread 는 자신만의 stack 을 가진다.
     ~~~
    public class StackAreaEx {
        public static void main(String[] args) {
            int a = 5;	a = 4;	a = 3;	a = 2;
            System.out.println(a);
            for(int i=0; i<5; i++){
            }
    //		System.out.println(i); 컴파일 에러  
        }
    }    
    ~~~
     위의 소스 코드처럼 a라는 변수는 main 메소드가 호출될 때 Stack 영역에 할당되고 종료 시 해제된다.   
     또한 a라는 변수의 값이 5, 4, 3, 2 순으로 값을 할당하였고 출력되는 값은 2가 출력된다.   
     이전 데이터는 지워지는 것이고 2라는 값만 출력된다.   
     즉, Stack 영역은 LIFO(Last In First Out)의 구조를 갖고 변수에 새로운 데이터가 할당되면 이전 데이터는 지워진다는 것을 알 수 있다.  

 또한 for문 내에 int i를 정의하였는데 for문이 종료된 다음 i를 출력하지 못하는 이유는 지역변수이므로 for문의 종료와 함께 Stack 영역에서 해제되었기 때문이다.
- Heap area(힙 메모리 영역)
    
     인스턴스를 생성하는 방법은 "클래스 변수 =  new 클래스();" 라는 것을 기억하면서 밑에 내용을 확인해 보자.
     참조형(Reference Type)의 데이터 타입을 갖는 객체(인스턴스), 배열 등은 Heap 영역에 데이터가 저장된다.   
     이때 변수(객체, 객체변수, 참조변수)는 Stack 영역의 공간에서 실제 데이터가 저장된 Heap 영역의 참조값(reference value, 해시코드 / 메모리에 저장된 주소를 연결해주는 값)을 new 연산자를 통해 리턴 받는다.  
     다시 말하면 실제 데이터를 갖고 있는 Heap 영역의 참조 값을 Stack 영역의 객체가 갖고 있다.   
     이렇게 리턴 받은 참조 값을 갖고 있는 객체를 통해서만 해당 인스턴스를 핸들 할 수 있다.
     - Heap 영역에는 주로 긴 생명주기를 가지는 데이터들이 저장된다. (대부분의 오브젝트는 크기가 크고, 서로 다른 코드블럭에서 공유되는 경우가 많다)
     - 애플리케이션의 모든 메모리 중 stack 에 있는 데이터를 제외한 부분이라고 보면 된다.
     - 모든 Object 타입(Integer, String, ArrayList, ...)은 heap 영역에 생성된다.
     - 몇개의 스레드가 존재하든 상관없이 단 하나의 heap 영역만 존재한다.
     -Heap 영역에 있는 오브젝트들을 가리키는 레퍼런스 변수가 stack 에 올라가게 된다.
     
     
-참조
    - https://m.blog.naver.com/heartflow89/220954420688
    - https://yaboong.github.io/java/2018/05/26/java-memory-management/